(async()=>{const e=location.pathname.split("/").pop(),t=await fetch("/api/videos/by-token/"+encodeURIComponent(e));if(!t.ok)return void alert("‚ùå Video tidak ditemukan");const n=await t.json(),o=document.getElementById("player"),a=document.getElementById("overlayContainer"),i=document.getElementById("clickOverlay"),d=document.getElementById("loadingOverlay");let r=0,l=!1;const c="https://example.com/directlink";let s=n.video_id,u=!1;"videy"===n.source?s=`https://cdn.videy.co/${encodeURIComponent(n.video_id)}.mp4`:n.source?.includes("dood")?(s=`https://dsvplay.com/e/${encodeURIComponent(n.video_id)}`,u=!0):n.source?.includes("videq")?(s=`https://videq.pw/e/${encodeURIComponent(n.video_id)}`,u=!0):n.source?.includes("lixstream")&&(s=`https://lixstream.com/e/${encodeURIComponent(n.video_id)}`,u=!0),u?document.getElementById("videoContainer").innerHTML=`<iframe src="${s}" allow="autoplay; fullscreen; encrypted-media" allowfullscreen style="width:100%;height:100%;border:0;"></iframe>`:(s.endsWith(".m3u8")?Hls.isSupported()?(hls=new Hls(),hls.loadSource(s),hls.attachMedia(o)):o.canPlayType("application/vnd.apple.mpegurl")&&(o.src=s,o.load()):s.endsWith(".mp4")&&(o.src=s,o.load()),new Plyr(o,{controls:["play","progress","current-time","mute","volume","fullscreen"]}),o.addEventListener("loadeddata",()=>{o.pause()}),i.addEventListener("click",()=>{1==(r+=1)?function(e){const t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noopener noreferrer",document.body.appendChild(t),t.click(),t.remove()}(c):2==r&&(a.style.display="none",d.style.display="flex",o.play().catch(()=>{}))}),o.addEventListener("canplay",()=>{d.style.display="none"}),o.addEventListener("playing",()=>{d.style.display="none"}),o.addEventListener("playing",async()=>{l||(l=!0,await fetch("/api/videos/"+n.id+"/view",{method:"POST"}).catch(()=>{}))}))})();
